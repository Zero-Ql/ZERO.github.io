document.addEventListener("DOMContentLoaded",()=>{let i=window.CONFIG,e=window.CONFIG.local_search.path;if(e){let n=new LocalSearch({path:e,top_n_per_article:i.localsearch.top_n_per_article,unescape:i.localsearch.unescape}),r=document.querySelector(".search-input"),t=()=>{if(n.isfetched){let e=r.value.trim().toLowerCase(),t=e.split(/[-\s]+/),s=document.querySelector(".search-result-container"),a=[];var c;0<e.length&&(a=n.getResultItems(t)),1===t.length&&""===t[0]?(s.classList.add("no-result"),s.innerHTML='<div class="search-result-icon"><i class="fa fa-search fa-5x"></i></div>'):0===a.length?(s.classList.add("no-result"),s.innerHTML='<div class="search-result-icon"><i class="far fa-frown fa-5x"></i></div>'):(a.sort((e,t)=>e.includedCount!==t.includedCount?t.includedCount-e.includedCount:e.hitCount!==t.hitCount?t.hitCount-e.hitCount:t.id-e.id),c=i.i18n.hits.replace(/\$\{hits}/,a.length),s.classList.remove("no-result"),s.innerHTML=`<div class="search-stats">${c}</div>
        <hr>
        <ul class="search-result-list">${a.map(e=>e.item).join("")}</ul>`)}};n.highlightSearchWords(document.querySelector(".post-body")),i.localsearch.preload&&n.fetchData(),"auto"===i.localsearch.trigger?r.addEventListener("input",t):(document.querySelector(".search-icon").addEventListener("click",t),r.addEventListener("keypress",e=>{"Enter"===e.key&&t()})),window.addEventListener("search:loaded",t),document.querySelectorAll(".popup-trigger").forEach(e=>{e.addEventListener("click",()=>{document.body.classList.add("search-active"),setTimeout(()=>r.focus(),500),n.isfetched||n.fetchData()})})}else console.warn("`hexo-generator-searchdb` plugin is not installed!")});